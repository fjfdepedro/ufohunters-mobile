<!DOCTYPE HTML>
<html>
<head>
   <title>UFO Hunters</title>
   <script type="text/javascript" charset="utf-8">

    document.addEventListener("deviceready", onDeviceReady, false);

    function onDeviceReady() {
        //navigator.geolocation.getCurrentPosition(onSuccess, onError, { enableHighAccuracy: true });
        var geo = cordova.require('cordova/plugin/geolocation');
        geo.getCurrentPosition(onSuccess, onError, { enableHighAccuracy: true });
    }

    function onSuccess(position) {
        var element = document.getElementById('geolocation');
        element.innerHTML = 'Lat: ' + position.coords.latitude + '<br />' +
          'Long: '        + position.coords.longitude         + '\n' +
          'Alt: '         + position.coords.altitude          + '\n' +
          'Precission: '       + position.coords.accuracy          + '\n');

        showLocation(position.coords.latitude, position.coords.longitude);
    }

    function onError(error) {
        alert('code: '    + error.code    + '\n' +
              'message: ' + error.message + '\n');
    }

    function showLocation(lat, lon) {
      console.log("geo: " + lat + "," + lon);
      
      var map = L.map('map').setView([lat, lon], 14); 
      L.tileLayer(' http://tile.openstreetmap.org/{z}/{x}/{y}.png', { 
        maxZoom: 18 
      }).addTo(map); 
      
      L.marker([lat, lon]).addTo(map); 
    } 

    </script>

</head>

<body>

<div id="mapPage" data-role="page" data-add-back-btn="true">
  <div data-role="header">
    <h1>UFO Hunters</h1>
  </div>

  <div data-role="content">
    <p id="geolocation">Finding geolocation...</p>
    <div id="map" style="width: 100%; height:100%;"></div>
  </div>
</div>

</body>

</html>